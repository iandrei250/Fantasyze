<template>
  <div class="mt-10 grid grid-cols-1 gap-x-6 gap-y-8 sm:grid-cols-6">
    <div class="sm:col-span-4">
      <label for="username" class="block text-sm/6 font-medium">Username</label>
      <div class="mt-2">
        <div
          class="flex items-center rounded-md bg-white pl-3 outline-1 -outline-offset-1 outline-gray-300 focus-within:outline-2 focus-within:-outline-offset-2 focus-within:outline-indigo-600"
        >
          <input
            type="text"
            name="username"
            id="username"
            v-model="hero.name"
            class="block min-w-0 grow py-1.5 pr-3 pl-1 text-base text-gray-900 placeholder:text-gray-400 focus:outline-none sm:text-sm/6"
            placeholder=""
          />
        </div>
      </div>
    </div>

    <div class="col-span-full">
      <label for="about" class="block text-sm/6 font-medium">Description</label>
      <div class="mt-2">
        <textarea
          name="about"
          id="about"
          rows="3"
          v-model="hero.description"
          class="block w-full rounded-md text-black bg-white px-3 py-1.5 text-base outline-1 -outline-offset-1 outline-gray-300 placeholder:text-gray-400 focus:outline-2 focus:-outline-offset-2 focus:outline-indigo-600 sm:text-sm/6"
        ></textarea>
      </div>
    </div>
    <div class="col-span-full">
      <label for="cover-photo" class="block text-sm/6 font-medium">Cover photo</label>
      <div>
        <div class="text-center">
          <svg
            class="mx-auto size-12 text-gray-300"
            viewBox="0 0 24 24"
            fill="currentColor"
            aria-hidden="true"
            data-slot="icon"
          >
            <path
              fill-rule="evenodd"
              d="M1.5 6a2.25 2.25 0 0 1 2.25-2.25h16.5A2.25 2.25 0 0 1 22.5 6v12a2.25 2.25 0 0 1-2.25 2.25H3.75A2.25 2.25 0 0 1 1.5 18V6ZM3 16.06V18c0 .414.336.75.75.75h16.5A.75.75 0 0 0 21 18v-1.94l-2.69-2.689a1.5 1.5 0 0 0-2.12 0l-.88.879.97.97a.75.75 0 1 1-1.06 1.06l-5.16-5.159a1.5 1.5 0 0 0-2.12 0L3 16.061Zm10.125-7.81a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Z"
              clip-rule="evenodd"
            />
          </svg>
          <div class="mt-4 flex text-sm/6">
            <label
              for="file-upload"
              class="relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 focus-within:outline-hidden hover:text-indigo-500"
            >
              <span class="p-1">Upload a file</span>
              <input
                id="file-upload"
                name="file-upload"
                type="file"
                class="sr-only"
                @change="handleFileUpload"
              />
            </label>
            <p class="pl-1">or drag and drop</p>
          </div>
        </div>
      </div>
    </div>
    <div @click="submitForm()">Create Character</div>
  </div>
</template>

<script lang="ts">
import { createHero } from '@/helpers/api/heroesApiRequests'
import { Button } from 'primevue'

export default {
  data() {
    return {
      hero: {
        name: '',
        description: '',
        image: null as File | null,
      },
    }
  },

  methods: {
    handleFileUpload(event: Event) {
      const target = event.target as HTMLInputElement
      if (target.files && target.files.length > 0) {
        this.hero.image = target.files[0]
      }
    },

    submitForm() {
      const formData = new FormData()
      formData.append('name', this.hero.name)
      formData.append('description', this.hero.description)
      if (this.hero.image) {
        formData.append('image', this.hero.image)
      }
      createHero(formData)
    },
  },
}
</script>
